<!DOCTYPE html>
<html lang="zh-TW" data-bs-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>室內裝修報價系統 - 完整版</title>
  <meta name="robots" content="noindex, nofollow">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.0/dist/darkly/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; }
    .display-4 { font-weight: 600; color: var(--bs-primary); }
    .card { border: none; box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,.075); margin-bottom: 1.5rem; }
    .card-header { background-color: var(--bs-dark); border-bottom: 2px solid var(--bs-primary); font-weight: 600; }
    .form-control:focus, .form-select:focus { border-color: var(--bs-primary); box-shadow: 0 0 0 0.2rem rgba(13,110,253,.25); }
    .pricing-breakdown { animation: fadeIn .3s ease-in; }
    @keyframes fadeIn { from {opacity:0; transform: translateY(10px);} to {opacity:1; transform: translateY(0);} }
    .auto-calc { background-color: rgba(13,110,253,.1); border-color: var(--bs-primary); }
    .input-group-text { background-color: var(--bs-secondary); border-color: var(--bs-border-color); }
    .custom-input { display: none; } .custom-input.show { display: block; }
  </style>

  <!-- 簡易密碼門禁 -->
  <script>
    (function () {
      var pass = prompt("請輸入密碼以訪問報價系統");
      if (pass !== "93784793") {
        document.documentElement.innerHTML = "<!DOCTYPE html><html><head><title>拒絕訪問</title><style>body{font-family:Arial,sans-serif;text-align:center;margin-top:100px;font-size:24px;color:#ff0000;background:#000;}</style></head><body><h1>無權訪問</h1><p>密碼錯誤，拒絕訪問此系統</p></body></html>";
        if (window.stop) window.stop();
        if (document.execCommand) document.execCommand("Stop");
        throw new Error("Access denied");
      }
    })();
  </script>
  <!-- 隱藏頁面內容直到密碼驗證完成 -->
  <style id="hideContent"> body { display: none !important; } </style>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var hideStyle = document.getElementById('hideContent');
      if (hideStyle) hideStyle.remove();
      document.body.style.display = 'block';
    });
  </script>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="text-center py-4 mb-4 border-bottom">
      <h1 class="display-4"><i class="fas fa-hammer me-3"></i>室內裝修報價系統</h1>
      <p class="lead text-muted">完整版 - 計算報價並匯出 Excel</p>
    </div>

    <div class="row">
      <!-- Input Form -->
      <div class="col-lg-8">
        <form id="quotationForm">
          <!-- 客戶資訊 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-user me-2"></i>客戶資訊</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="client_name" class="form-label">客戶名稱</label>
                  <input type="text" class="form-control" id="client_name" placeholder="可空白">
                </div>
                <div class="col-md-6 mb-3">
                  <label for="date" class="form-label">報價日期</label>
                  <input type="date" class="form-control" id="date">
                </div>
                <div class="col-12 mb-3">
                  <label for="address" class="form-label">地址</label>
                  <input type="text" class="form-control" id="address" placeholder="可空白">
                </div>
                <div class="col-md-6 mb-3">
                  <label for="style" class="form-label">風格</label>
                  <select class="form-select" id="style" onchange="toggleCustomInput('style')">
                    <option value="">請選擇風格</option>
                    <option value="簡約">簡約</option>
                    <option value="北歐">北歐</option>
                    <option value="清奢">清奢</option>
                    <option value="古典">古典</option>
                    <option value="美式">美式</option>
                    <option value="現代">現代</option>
                    <option value="日式">日式</option>
                    <option value="無印">無印</option>
                    <option value="其他">其他：自行輸入</option>
                  </select>
                  <input type="text" class="form-control mt-2 custom-input" id="style_custom" placeholder="請輸入自訂風格">
                </div>
                <div class="col-md-6 mb-3">
                  <label for="room_type" class="form-label">房型</label>
                  <select class="form-select" id="room_type" onchange="toggleCustomInput('room_type')">
                    <option value="">請選擇房型</option>
                    <option value="一房一廳一衛">一房一廳一衛</option>
                    <option value="兩房一廳一衛">兩房一廳一衛</option>
                    <option value="兩房兩廳兩衛">兩房兩廳兩衛</option>
                    <option value="三房一廳一衛">三房一廳一衛</option>
                    <option value="三房兩廳兩衛">三房兩廳兩衛</option>
                    <option value="三房兩廳三衛">三房兩廳三衛</option>
                    <option value="其他">其他：自行輸入</option>
                  </select>
                  <input type="text" class="form-control mt-2 custom-input" id="room_type_custom" placeholder="請輸入自訂房型">
                </div>
              </div>
            </div>
          </div>

          <!-- 基準坪數 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-ruler me-2"></i>基準坪數</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="base_ping" class="form-label">基準坪數 (12-40坪) *</label>
                  <input type="number" class="form-control" id="base_ping" min="12" max="40" value="20" required onchange="calculatePricing()">
                  <div class="form-text">影響所有基礎工程與區間價格計算</div>
                </div>
              </div>
            </div>
          </div>

          <!-- 基礎工程項目 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-tools me-2"></i>基礎工程項目</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="paint" onchange="calculatePricing()" checked>
                    <label class="form-check-label fw-bold" for="paint">油漆</label>
                    <div><small class="text-muted">基礎價格：90,000元 (12坪)，每坪增額：6,000元</small></div>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="electrical" onchange="calculatePricing()" checked>
                    <label class="form-check-label fw-bold" for="electrical">水電</label>
                    <div><small class="text-muted">基礎價格：60,000元 (12坪)，每坪增額：5,000元</small></div>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="lighting" onchange="calculatePricing()" checked>
                    <label class="form-check-label fw-bold" for="lighting">燈具</label>
                    <div><small class="text-muted">基礎價格：45,000元 (12坪)，每坪增額：3,000元</small></div>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="glass" onchange="calculatePricing()" checked>
                    <label class="form-check-label fw-bold" for="glass">玻璃</label>
                    <div><small class="text-muted">基礎價格：25,000元 (12坪)，每坪增額：3,000元</small></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 木作工程 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-tree me-2"></i>木作工程</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="aircond_woodwork" class="form-label">冷氣+窗簾盒</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="aircond_woodwork" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 1,500</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="wall_panel" class="form-label">壁板</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="wall_panel" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 4,500</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="low_screen_simple" class="form-label">矮屏(無造型)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="low_screen_simple" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 2,500</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="low_screen_curved" class="form-label">矮屏(有弧度)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="low_screen_curved" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 3,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="sliding_door_wood" class="form-label">拉門(含五金)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="sliding_door_wood" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">樘 × 33,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="room_door" class="form-label">房門(含五金)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="room_door" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">樘 × 33,000</span>
                  </div>
                </div>

                <div class="col-md-6 mb-3">
                  <label for="flat_ceiling" class="form-label">平釘天花板</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="flat_ceiling" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">坪 × 6,500</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="decorative_ceiling" class="form-label">造型天花板</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="decorative_ceiling" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">坪 × 7,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="partition_simple" class="form-label">隔間(無造型)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="partition_simple" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 4,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="partition_curved" class="form-label">隔間(有弧度)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="partition_curved" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 5,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="wall_ac_slot" class="form-label">壁掛冷氣凹槽</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="wall_ac_slot" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">空間 × 4,500</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="ceiling_ac_slot" class="form-label">吊隱冷氣凹槽</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="ceiling_ac_slot" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">空間 × 8,500</span>
                  </div>
                </div>
                <div class="col-12 mb-3">
                  <label for="woodwork_hardware" class="form-label">木作五金 (自動計算 - 木作總金額 × 5%)</label>
                  <input type="text" class="form-control auto-calc" id="woodwork_hardware" readonly>
                </div>
              </div>
            </div>
          </div>

          <!-- 系統櫃配置 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-cube me-2"></i>系統櫃配置</h5>
            </div>
            <div class="card-body">
              <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle me-2"></i>
                系統櫃以「尺」計價；<b>床架以公分計價（長cm × 寬cm）</b>
              </div>
              <div class="row">
                <div class="col-12 mb-3">
                  <label class="form-label fw-bold">床架配置 (長cm × 寬cm = 金額)</label>
                  <div class="card bg-secondary">
                    <div class="card-body">
                      <div id="bed-frames-container"><!-- 動態床架 --></div>
                      <button type="button" class="btn btn-outline-primary btn-sm" onclick="addBedFrame()">
                        <i class="fas fa-plus me-1"></i>新增床架
                      </button>
                    </div>
                  </div>
                </div>

                <div class="col-md-6 mb-3">
                  <label for="nightstand" class="form-label">床頭櫃</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="nightstand" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 6,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="wall_cabinet_door" class="form-label">吊櫃(有門片)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="wall_cabinet_door" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 5,500</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="wall_cabinet_no_door" class="form-label">吊櫃(無門片)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="wall_cabinet_no_door" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 5,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="tall_cabinet_no_drawer" class="form-label">高櫃(含書櫃40-50cm無抽屜)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="tall_cabinet_no_drawer" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 7,500</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="tall_cabinet_with_drawer" class="form-label">高櫃(含書櫃40-50cm有抽屜)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="tall_cabinet_with_drawer" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 8,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="wardrobe_door_60cm" class="form-label">衣櫃(門片含收納櫃60cm)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="wardrobe_door_60cm" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 8,500</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="wardrobe_slide_60cm" class="form-label">衣櫃(拉門含收納櫃60cm)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="wardrobe_slide_60cm" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 9,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="appliance_cabinet" class="form-label">電器櫃</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="appliance_cabinet" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 8,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="desk" class="form-label">書桌</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="desk" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 6,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="low_cabinet_no_drawer" class="form-label">矮櫃(無抽屜)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="low_cabinet_no_drawer" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 6,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="low_cabinet_with_drawer" class="form-label">矮櫃(有抽屜)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="low_cabinet_with_drawer" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 7,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="tv_cabinet" class="form-label">電視櫃</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="tv_cabinet" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 4,000</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="system_wall_panel" class="form-label">壁板</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="system_wall_panel" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">尺 × 3,000</span>
                  </div>
                </div>

                <div class="col-12 mb-3">
                  <label for="system_hardware" class="form-label">系統五金 (自動計算 - 系統總金額 × 5%)</label>
                  <input type="text" class="form-control auto-calc" id="system_hardware" readonly>
                </div>
                <div class="col-12 mb-3">
                  <label for="system_shipping" class="form-label">運費 (自動計算 - 系統總金額 × 5%)</label>
                  <input type="text" class="form-control auto-calc" id="system_shipping" readonly>
                </div>
                <div class="col-12 mb-3">
                  <label for="system_assembly" class="form-label">組裝費 (自動計算 - 系統總金額 × 20%)</label>
                  <input type="text" class="form-control auto-calc" id="system_assembly" readonly>
                </div>
              </div>
            </div>
          </div>

          <!-- 鐵件拉門 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-door-open me-2"></i>鐵件拉門</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="iron_sliding_door" class="form-label">鐵件拉門(含五金)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="iron_sliding_door" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">樘 × 28,000</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 開關面板 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-toggle-on me-2"></i>開關面板</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="switch_panel" class="form-label">選擇開關面板</label>
                  <select class="form-select" id="switch_panel" onchange="calculatePricing()">
                    <option value="starlight" selected>星光 - 基數7000 每坪+600</option>
                    <option value="risna">Risna - 基數9000 每坪+700</option>
                  </select>
                  <small class="text-muted">基數為12坪，每多1坪按對應金額計算</small>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="switch_panel_calc" class="form-label">開關面板金額 (自動計算)</label>
                  <input type="text" class="form-control auto-calc" id="switch_panel_calc" readonly>
                </div>
              </div>
            </div>
          </div>

          <!-- 石作工程 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-square me-2"></i>石作工程</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="large_board" class="form-label">大板</label>
                  <select class="form-select" id="large_board" onchange="toggleCustomInput('large_board'); calculatePricing()">
                    <option value="0">不選擇</option>
                    <option value="60000">一般 - 60,000</option>
                    <option value="120000">貴一點 - 120,000</option>
                    <option value="200000">最貴 - 200,000</option>
                    <option value="custom">自行輸入金額</option>
                  </select>
                  <input type="number" class="form-control mt-2 custom-input" id="large_board_custom" placeholder="請輸入金額" onchange="calculatePricing()">
                </div>
              </div>
            </div>
          </div>

          <!-- 特殊漆工程 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-paint-roller me-2"></i>特殊漆工程</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="special_paint" class="form-label">特殊漆</label>
                  <select class="form-select" id="special_paint" onchange="toggleCustomInput('special_paint'); calculatePricing()">
                    <option value="0">不選擇</option>
                    <option value="50000">一般 - 50,000</option>
                    <option value="100000">貴一點 - 100,000</option>
                    <option value="150000">最貴 - 150,000</option>
                    <option value="custom">自行輸入金額</option>
                  </select>
                  <input type="number" class="form-control mt-2 custom-input" id="special_paint_custom" placeholder="請輸入金額" onchange="calculatePricing()">
                </div>
              </div>
            </div>
          </div>

          <!-- 鐵件工程 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-tools me-2"></i>鐵件工程</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="ironwork" class="form-label">鐵件</label>
                  <select class="form-select" id="ironwork" onchange="toggleCustomInput('ironwork'); calculatePricing()">
                    <option value="0">不選擇</option>
                    <option value="40000">一般 - 40,000</option>
                    <option value="80000">貴一點 - 80,000</option>
                    <option value="120000">最貴 - 120,000</option>
                    <option value="custom">自行輸入金額</option>
                  </select>
                  <input type="number" class="form-control mt-2 custom-input" id="ironwork_custom" placeholder="請輸入金額" onchange="calculatePricing()">
                </div>
              </div>
            </div>
          </div>

          <!-- 金屬工程 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-cogs me-2"></i>金屬工程</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="titanium_strips" class="form-label">鈦金條</label>
                  <select class="form-select" id="titanium_strips" onchange="toggleCustomInput('titanium_strips'); calculatePricing()">
                    <option value="0">不選擇</option>
                    <option value="10000">少-4條 - 10,000</option>
                    <option value="15000">中-6條 - 15,000</option>
                    <option value="20000">多-8條 - 20,000</option>
                    <option value="custom">自行輸入金額</option>
                  </select>
                  <input type="number" class="form-control mt-2 custom-input" id="titanium_strips_custom" placeholder="請輸入金額" onchange="calculatePricing()">
                </div>
              </div>
            </div>
          </div>

          <!-- 鋁框吊框 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-window-maximize me-2"></i>鋁框吊框</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-4 mb-3">
                  <label for="aluminum_40x70" class="form-label">40*70</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="aluminum_40x70" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">樘 × 2,300</span>
                  </div>
                </div>
                <div class="col-md-4 mb-3">
                  <label for="aluminum_45x70" class="form-label">45*70</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="aluminum_45x70" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">樘 × 2,600</span>
                  </div>
                </div>
                <div class="col-md-4 mb-3">
                  <label for="aluminum_50x70" class="form-label">50*70</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="aluminum_50x70" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">樘 × 3,000</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 高門框 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-door-closed me-2"></i>高門框</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-4 mb-3">
                  <label for="tall_frame_40x240" class="form-label">40*240</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="tall_frame_40x240" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">樘 × 7,500</span>
                  </div>
                </div>
                <div class="col-md-4 mb-3">
                  <label for="tall_frame_45x240" class="form-label">45*240</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="tall_frame_45x240" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">樘 × 8,500</span>
                  </div>
                </div>
                <div class="col-md-4 mb-3">
                  <label for="tall_frame_50x240" class="form-label">50*240</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="tall_frame_50x240" min="0" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">樘 × 9,500</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 其他單價項目 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-list me-2"></i>其他單價項目</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="cleaning" class="form-label">清潔 (全室含衛浴/陽台/廚房)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="cleaning" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">坪 × 1,200</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="wood_flooring" class="form-label">木地板 (不含衛浴/陽台/廚房)</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="wood_flooring" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">坪 × 6,500</span>
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="protection" class="form-label">室內保護</label>
                  <div class="input-group">
                    <input type="number" class="form-control" id="protection" min="0" step="0.1" value="0" onchange="calculatePricing()">
                    <span class="input-group-text">坪 × 1,000</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 其他項目（尚未計算的項目） -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-plus me-2"></i>其他項目 (尚未計算的項目)</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-12 mb-3">
                  <label for="other_items" class="form-label">其他項目 (自動計算 - 總金額 × 10%)</label>
                  <input type="text" class="form-control auto-calc" id="other_items" readonly>
                </div>
              </div>
            </div>
          </div>

          <!-- 監工費和稅額 -->
          <div class="card mb-4">
            <div class="card-header">
              <h5 class="card-title mb-0"><i class="fas fa-calculator me-2"></i>費用計算</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="supervision_fee" class="form-label">監工費 (自動計算 - 8%)</label>
                  <input type="text" class="form-control auto-calc" id="supervision_fee" readonly>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="tax" class="form-label">稅額 (自動計算 - 5%)</label>
                  <input type="text" class="form-control auto-calc" id="tax" readonly>
                </div>
              </div>
            </div>
          </div>

          <!-- 按鈕 -->
          <div class="row">
            <div class="col-12">
              <div class="d-grid gap-2">
                <button type="button" class="btn btn-primary btn-lg" onclick="calculatePricing()">
                  <i class="fas fa-calculator me-2"></i>重新計算報價
                </button>
                <button type="button" class="btn btn-success btn-lg" onclick="exportToExcel()">
                  <i class="fas fa-download me-2"></i>匯出 Excel 報價單
                </button>
                <button type="button" class="btn btn-outline-primary btn-lg" onclick="saveQuote()">
                  <i class="fas fa-cloud-upload-alt me-2"></i>儲存到資料庫
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>

      <!-- 價格顯示區域 -->
      <div class="col-lg-4">
        <div class="sticky-top" style="top: 2rem;">
          <div class="card mb-4">
            <div class="card-header text-center">
              <h5 class="card-title mb-0">
                <i class="fas fa-dollar-sign me-2"></i>總報價
              </h5>
            </div>
            <div class="card-body text-center">
              <h2 class="display-5 text-primary fw-bold" id="total-price">NT$ 0</h2>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h6 class="card-title mb-0">
                <i class="fas fa-list-ul me-2"></i>價格明細
              </h6>
            </div>
            <div class="card-body">
              <div id="pricing-breakdown" class="pricing-breakdown">
